load("//rule:junit_test.bzl", "kt_junit_test")

java_library(
    name = "runfile_dummy_lib",
    srcs = [
        "RunfileDummy.java",
    ],
    deps = [
        "@bazel_tools//tools/java/runfiles",
    ],
)

kt_junit_test(
    name = "glb-load-test",
    srcs = ["GlbLoadTest.kt"],
    data = [
        "//blazerod/model/example-models:alicia_solid_vrm",
        "//blazerod/model/example-models:armorstand_vrm",
        "//blazerod/model/example-models:interpolation_test_glb",
    ],
    jvm_flags = [
        "-Dalicia_solid_path=$(rlocationpath //blazerod/model/example-models:alicia_solid_vrm)",
        "-Darmorstand_path=$(rlocationpath //blazerod/model/example-models:armorstand_vrm)",
        "-Dinterpolation_test_path=$(rlocationpath //blazerod/model/example-models:interpolation_test_glb)",
    ],
    test_class = "top.fifthlight.blazerod.model.gltf.test.GlbLoadTest",
    deps = [
        ":runfile_dummy_lib",
        "//blazerod/model/model-base",
        "//blazerod/model/model-gltf",
        "@maven//:org_jetbrains_kotlin_kotlin_test",
    ],
)

test_suite(
    name = "test",
    tests = [
        ":glb-load-test",
    ],
    visibility = ["//blazerod/render/main/layout:__pkg__"],
)
