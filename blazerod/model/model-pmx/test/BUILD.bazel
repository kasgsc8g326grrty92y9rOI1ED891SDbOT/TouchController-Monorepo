load("@rules_java//java:defs.bzl", "java_library")
load("//rule:junit_test.bzl", "kt_junit_test")

java_library(
    name = "runfile_dummy_lib",
    srcs = [
        "RunfileDummy.java",
    ],
    deps = [
        "@bazel_tools//tools/java/runfiles",
    ],
)

kt_junit_test(
    name = "pmx-load-test",
    srcs = ["PmxLoadTest.kt"],
    data = [
        "//blazerod/model/example-models:alicia_blade_pmx",
        "//blazerod/model/example-models:alicia_solid_mmd",
        "//blazerod/model/example-models:alicia_solid_pmx",
    ],
    jvm_flags = [
        "-Dalicia_solid_path=$(rlocationpath //blazerod/model/example-models:alicia_solid_pmx)",
        "-Dalicia_blade_path=$(rlocationpath //blazerod/model/example-models:alicia_blade_pmx)",
    ],
    test_class = "top.fifthlight.blazerod.model.pmx.test.PmxLoadTest",
    deps = [
        ":runfile_dummy_lib",
        "//blazerod/model/model-base",
        "//blazerod/model/model-loader",
        "//blazerod/model/model-pmx",
        "@maven//:org_jetbrains_kotlin_kotlin_test",
    ],
)

test_suite(
    name = "test",
    tests = [
        ":pmx-load-test",
    ],
    visibility = ["//blazerod/render/main/layout:__pkg__"],
)
